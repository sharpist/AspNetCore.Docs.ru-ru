---
Title: "Управление пользователями и группами в SignalR " Автор: брадигастер Description: "Общие сведения о ASP.NET Core SignalR управлении пользователями и группами."
Моникерранже: ' >= aspnetcore-2,1 ' MS. author: брадиг MS. Custom: MVC MS. Дата: 05/17/2020 No-Loc:
- 'Blazor'
- 'Identity'
- 'Let's Encrypt'
- 'Razor'
- ' SignalR ' UID: SignalR/Groups

---

# <a name="manage-users-and-groups-in-signalr"></a>Управление пользователями и группами вSignalR

По [Бреннан Конрой](https://github.com/BrennanConroy)

SignalRразрешает отправлять сообщения всем соединениям, связанным с конкретным пользователем, а также именованным группам подключений.

[Просмотреть или скачать образец кода](https://github.com/dotnet/AspNetCore.Docs/tree/master/aspnetcore/signalr/groups/sample/) [(описание загрузки)](xref:index#how-to-download-a-sample)

## <a name="users-in-signalr"></a>Пользователи вSignalR

Один пользователь в SignalR может иметь несколько подключений к приложению. Например, пользователь может подключаться к рабочему столу, а также по телефону. Каждое устройство имеет отдельное SignalR соединение, но все они связаны с одним и тем же пользователем. При отправке пользователю сообщения все соединения, связанные с этим пользователем, получают сообщение. Доступ к идентификатору пользователя для соединения может осуществляться `Context.UserIdentifier` свойством в концентраторе.

По умолчанию SignalR использует `ClaimTypes.NameIdentifier` из из, `ClaimsPrincipal` связанного с соединением, в качестве идентификатора пользователя. Сведения о настройке этого поведения см. в разделе [использование утверждений для настройки обработки удостоверений](xref:signalr/authn-and-authz#use-claims-to-customize-identity-handling).

Отправьте сообщение определенному пользователю, передав идентификатор пользователя в `User` функцию в методе концентратора, как показано в следующем примере:

> [!NOTE]
> В идентификаторе пользователя учитывается регистр.

[!code-csharp[Configure service](groups/sample/Hubs/ChatHub.cs?range=29-32)]

## <a name="groups-in-signalr"></a>Группы вSignalR

Группа — это коллекция соединений, связанных с именем. Сообщения могут отправляться всем подключениям в группе. Группы — это рекомендуемый способ отправки на подключение или несколько подключений, так как группы управляются приложением. Соединение может быть членом нескольких групп. Группы идеально подходят для приложения разговора, где каждая комната может быть представлена группой. Соединения добавляются в группы или удаляются из групп с помощью `AddToGroupAsync` `RemoveFromGroupAsync` методов и.

[!code-csharp[Hub methods](groups/sample/Hubs/ChatHub.cs?range=15-27)]

Членство в группе не сохраняется при повторном подключении подключения. Соединение должно повторно присоединиться к группе, когда она будет восстановлена. Невозможно подсчитать членов группы, так как эта информация недоступна, если приложение масштабируется до нескольких серверов.

Чтобы защитить доступ к ресурсам при использовании групп, используйте функции [проверки подлинности и авторизации](xref:signalr/authn-and-authz) в ASP.NET Core. Если пользователь добавлен в группу только в том случае, если учетные данные действительны для этой группы, сообщения, отправленные в эту группу, будут отправляться только полномочным пользователям. Однако группы не являются функцией безопасности. Утверждения проверки подлинности имеют функции, которые не являются группами, например срок действия и отзыв. Если разрешение пользователя на доступ к группе отменено, приложение должно явным образом удалить пользователя из группы.

> [!NOTE]
> В именах групп учитывается регистр.

## <a name="related-resources"></a>Связанные ресурсы

* [Начало работы](xref:tutorials/signalr)
* [Концентраторы](xref:signalr/hubs)
* [Публикация в Azure](xref:signalr/publish-to-azure-web-app)
